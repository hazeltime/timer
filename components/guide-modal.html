<!-- components/guide-modal.html -->
<div id="guide-modal" class="modal-overlay" style="display: none;">
  <div class="modal-content guide-modal-content">
    <button id="guide-modal-close-btn" class="modal-close-btn"><i class="fas fa-times"></i></button>
    <h2>Welcome to the Advanced Task Timer!</h2>
    <p>This guide will walk you through all the features of this powerful time management tool.</p>
    
    <h3>1. Creating and Managing Tasks</h3>
    <p>The "Create New Task" panel is where you define the tasks you want to work on.</p>
    <ul>
      <li><strong>Title & Description:</strong> Give your task a clear title and an optional description.</li>
      <li><strong>Category:</strong> Assign a category to your task for better organization.</li>
      <li><strong>Duration:</strong> Set the base duration for your task in minutes and seconds.</li>
      <li><strong>Lap Interval:</strong> This determines how often the task will appear in a session.
        <ul>
          <li><code>1</code>: The task will run in every lap.</li>
          <li><code>2</code>: The task will run in every other lap (1, 3, 5, ...).</li>
          <li><code>3</code>: The task will run in every third lap (1, 4, 7, ...).</li>
        </ul>
      </li>
      <li><strong>Growth Factor (%):</strong>  This allows you to increase or decrease the task's duration over time. The duration will be recalculated for each occurrence based on this percentage. For example, a growth factor of 10% will increase the duration by 10% for each subsequent execution.</li>
      <li><strong>Max Occurrences:</strong> Set a limit on how many times a task can run in a single session. <code>0</code> means no limit.</li>
    </ul>
    <p><strong>Example:</strong>
    Let's say you want to create a task for a 5-minute meditation that you do every day.
    - Title: "Meditation"
    - Duration: 5 minutes
    - Lap Interval: 1 (since you do it daily)</p>

    <h3>2. The Task Repository</h3>
    <p>All the tasks you create are stored in the "Task Repository". From here you can:</p>
    <ul>
      <li><strong>Sort:</strong> Click on the table headers to sort your tasks by different criteria.</li>
      <li><strong>Add to Playlist:</strong> Click the <code>+</code> button to add a task to the "Playlist".</li>
      <li><strong>Edit:</strong> Click the pencil icon to load a task back into the form for editing.</li>
      <li><strong>Duplicate:</strong> Click the copy icon to create a copy of a task.</li>
      <li><strong>Delete:</strong> Click the trash icon to permanently delete a task.</li>
    </ul>

    <h3>3. The Playlist</h3>
    <p>The "Playlist" is where you build your session for the day. It's an ordered list of tasks that will be executed by the "Task Runner".</p>
    <ul>
      <li><strong>Add tasks:</strong> Add tasks from the repository to the playlist.</li>
      <li><strong>Reorder:</strong> Drag and drop tasks to change their execution order.</li>
      <li><strong>Remove:</strong> Click the trash icon to remove a task from the playlist.</li>
      <li><strong>Clear:</strong> Use the "Clear Playlist" button to remove all tasks from the playlist.</li>
    </ul>

    <h3>4. The Task Runner</h3>
    <p>The "Task Runner" is the heart of the application. It executes the tasks in your playlist.</p>
    <ul>
      <li><strong>Laps:</strong> Set the number of laps you want to run. A lap is one full cycle through the scheduled tasks in your playlist.</li>
      <li><strong>Play/Pause:</strong> Start, pause, or resume the session.</li>
      <li><strong>Next/Prev Task:</strong> Manually skip to the next or previous task in the session.</li>
      <li><strong>Next/Prev Lap:</strong> Skip to the first task of the next or previous lap.</li>
      <li><strong>Stop:</strong> Stop the current session.</li>
      <li><strong>Restart:</strong> Restart the current session from the beginning.</li>
      <li><strong>Focus Mode:</strong> Click the expand icon to enter a distraction-free focus mode.</li>
    </ul>
    <p><strong>How it works:</strong>
    The runner builds a "virtual playlist" based on your lap list and the lap/occurrence settings of each task. It then runs through this virtual playlist.</p>

    <h3>5. Advanced Features</h3>
    <ul>
      <li><strong>Themes:</strong> Switch between light and dark themes using the toggle in the header.</li>
      <li><strong>Global Collapse/Expand:</strong> Collapse or expand all panels at once.</li>
      <li><strong>Persistent State:</strong> Your tasks and playlist are saved in your browser's local storage, so they will be there when you come back.</li>
    </ul>
    <p>We hope you enjoy using the Advanced Task Timer!</p>
  </div>
</div>