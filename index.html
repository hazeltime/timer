<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo Task Timer (TTT)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1><i class="fas fa-tasks"></i> Todo Task Timer</h1>
        <div class="header-controls">
          <button
            id="reset-app-btn"
            class="theme-btn"
            title="Reset and Load Demo"
          >
            <i class="fas fa-undo"></i>
          </button>
          <button id="theme-toggle-btn" class="theme-btn" title="Toggle Theme">
            <i class="fas fa-sun"></i>
            <i class="fas fa-moon"></i>
          </button>
        </div>
      </header>
      <main class="main-layout">
        <div class="left-column">
          <section class="panel" id="create-task-panel">
            <div class="panel-header">
              <h2 id="form-title">Create New Task</h2>
              <button
                class="collapse-btn"
                aria-expanded="true"
                aria-controls="create-task-content"
              >
                <i class="fas fa-chevron-up"></i>
              </button>
            </div>
            <div id="create-task-content" class="panel-content">
              <div>
                <div id="task-form" class="input-grid">
                  <div class="form-row-split">
                    <div class="form-group">
                      <label for="task-input">Title</label>
                      <input
                        type="text"
                        id="task-input"
                        placeholder="e.g., Finish project report"
                      />
                    </div>
                    <div class="form-group description-group">
                      <label for="task-description-input"
                        >Description (Optional)</label
                      >
                      <textarea
                        id="task-description-input"
                        placeholder="e.g., Finalize introduction and conclusion."
                      ></textarea>
                    </div>
                  </div>

                  <div class="form-row-split-advanced">
                    <div class="form-group category-group">
                      <label>Category</label>
                      <div id="category-grid" class="category-grid"></div>
                    </div>
                    <div class="form-column">
                      <fieldset class="form-group">
                        <legend>Lap Interval</legend>
                        <div class="lap-interval-controls">
                          <div class="stepper-input">
                            <button
                              class="stepper-btn"
                              data-field="lapInterval"
                              data-step="-1"
                              aria-label="Decrease Lap Interval"
                            >
                              -
                            </button>
                            <input
                              type="number"
                              id="lap-interval-input"
                              value="1"
                              min="1"
                              max="99"
                            />
                            <button
                              class="stepper-btn"
                              data-field="lapInterval"
                              data-step="1"
                              aria-label="Increase Lap Interval"
                            >
                              +
                            </button>
                          </div>
                          <span class="field-description"
                            >Skips (N-1) laps after each run</span
                          >
                        </div>
                      </fieldset>
                      <fieldset class="form-group">
                        <legend>Duration Growth/Decay</legend>
                        <div class="growth-factor-controls">
                          <div class="stepper-input">
                            <button
                              class="stepper-btn"
                              data-field="growthFactor"
                              data-step="-5"
                              aria-label="Decrease growth factor"
                            >
                              -5%
                            </button>
                            <input
                              type="number"
                              id="growth-factor-input"
                              value="0"
                              min="-99"
                              max="99"
                            />
                            <button
                              class="stepper-btn"
                              data-field="growthFactor"
                              data-step="5"
                              aria-label="Increase growth factor"
                            >
                              +5%
                            </button>
                          </div>
                          <span class="field-description"
                            >Changes duration by this % each run</span
                          >
                        </div>
                      </fieldset>
                    </div>
                  </div>

                  <div class="form-group duration-container-group">
                    <fieldset>
                      <legend>Duration</legend>
                      <div class="duration-layout-grid">
                        <div class="duration-inputs-wrapper">
                          <div class="duration-input-group">
                            <label for="task-duration-minutes">Minutes</label>
                            <div class="stepper-input">
                              <button
                                class="stepper-btn"
                                data-field="minutes"
                                data-step="-1"
                                aria-label="Decrease minutes"
                              >
                                -
                              </button>
                              <input
                                type="number"
                                id="task-duration-minutes"
                                min="0"
                              />
                              <button
                                class="stepper-btn"
                                data-field="minutes"
                                data-step="1"
                                aria-label="Increase minutes"
                              >
                                +
                              </button>
                            </div>
                          </div>
                          <div class="duration-input-group">
                            <label for="task-duration-seconds">Seconds</label>
                            <div class="stepper-input">
                              <button
                                class="stepper-btn"
                                data-field="seconds"
                                data-step="-1"
                                aria-label="Decrease seconds"
                              >
                                -
                              </button>
                              <input
                                type="number"
                                id="task-duration-seconds"
                                min="0"
                                max="59"
                              />
                              <button
                                class="stepper-btn"
                                data-field="seconds"
                                data-step="1"
                                aria-label="Increase seconds"
                              >
                                +
                              </button>
                            </div>
                          </div>
                        </div>
                        <div class="preset-group">
                          <label>Presets</label>
                          <div class="preset-durations">
                            <button class="preset-btn" data-duration="30">
                              30s
                            </button>
                            <button class="preset-btn" data-duration="120">
                              2m
                            </button>
                            <button class="preset-btn" data-duration="300">
                              5m
                            </button>
                            <button class="preset-btn" data-duration="600">
                              10m
                            </button>
                            <button class="preset-btn" data-duration="900">
                              15m
                            </button>
                            <button class="preset-btn" data-duration="1500">
                              25m
                            </button>
                          </div>
                        </div>
                      </div>
                    </fieldset>
                  </div>
                  <div class="form-group add-btn-group">
                    <button id="add-task-btn">
                      <i class="fas fa-plus"></i> Add Task
                    </button>
                    <button id="cancel-edit-btn" style="display: none">
                      <i class="fas fa-times"></i> Cancel Edit
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>
          <hr class="panel-divider" />
          <section class="panel" id="task-repository-panel">
            <div class="panel-header repo-header">
              <h2>Task Repository</h2>
              <div class="repo-controls">
                <button id="add-all-btn" class="repo-btn">
                  <i class="fas fa-plus-square"></i> Add All
                </button>
                <button id="delete-all-btn" class="delete-all">
                  <i class="fas fa-trash-alt"></i> Delete All
                </button>
              </div>
              <button
                class="collapse-btn"
                aria-expanded="true"
                aria-controls="task-repository-content"
              >
                <i class="fas fa-chevron-up"></i>
              </button>
            </div>
            <div id="task-repository-content" class="panel-content">
              <div>
                <div class="task-list-container">
                  <div class="task-list-header">
                    <div
                      class="task-cell task-id-col sort-header"
                      id="sort-by-id-btn"
                      role="button"
                      tabindex="0"
                    >
                      # <i class="fas"></i>
                    </div>
                    <div
                      class="task-cell task-title-col sort-header"
                      id="sort-by-title-btn"
                      role="button"
                      tabindex="0"
                    >
                      Task <i class="fas"></i>
                    </div>
                    <div
                      class="task-cell task-category-col sort-header"
                      id="sort-by-category-btn"
                      role="button"
                      tabindex="0"
                    >
                      Category <i class="fas"></i>
                    </div>
                    <div
                      class="task-cell task-duration-col sort-header"
                      id="sort-by-duration-btn"
                      role="button"
                      tabindex="0"
                    >
                      Duration <i class="fas"></i>
                    </div>
                    <div
                      class="task-cell task-interval-col sort-header"
                      id="sort-by-lapInterval-btn"
                      role="button"
                      tabindex="0"
                    >
                      Interval <i class="fas"></i>
                    </div>
                    <div
                      class="task-cell task-growth-col sort-header"
                      id="sort-by-growthFactor-btn"
                      role="button"
                      tabindex="0"
                    >
                      Growth <i class="fas"></i>
                    </div>
                    <div class="task-cell task-actions-col">Actions</div>
                  </div>
                  <div id="task-list"></div>
                </div>
                <footer class="task-list-footer">
                  <div id="no-tasks-message" style="display: none">
                    No tasks yet. Add one above!
                  </div>
                  <div id="task-summary"></div>
                </footer>
              </div>
            </div>
          </section>
        </div>
        <div class="right-column">
          <section class="panel" id="lap-list-panel">
            <div class="panel-header lap-list-header">
              <h2>Lap Playlist</h2>
              <div class="lap-list-controls">
                <span id="lap-list-duration">Total: 0s</span>
                <button
                  id="clear-lap-list-btn"
                  title="Clear Playlist"
                  class="btn-icon-danger"
                >
                  <i class="fas fa-trash-alt"></i>
                </button>
              </div>
              <button
                class="collapse-btn"
                aria-expanded="true"
                aria-controls="lap-list-content"
              >
                <i class="fas fa-chevron-up"></i>
              </button>
            </div>
            <div id="lap-list-content" class="panel-content">
              <div class="lap-list-wrapper">
                <div id="lap-list" class="lap-list"></div>
              </div>
            </div>
          </section>
          <hr class="panel-divider" />
          <section class="panel task-runner-panel" id="task-runner-panel">
            <div class="panel-header">
              <h2>Task Runner</h2>
              <button
                class="collapse-btn"
                aria-expanded="true"
                aria-controls="task-runner-content"
              >
                <i class="fas fa-chevron-up"></i>
              </button>
            </div>
            <div id="task-runner-content" class="panel-content">
              <div>
                <div id="runner-task-info">
                  <h3 id="runner-task-title">No task selected</h3>
                  <span id="runner-task-category"></span>
                </div>
                <div class="runner-details-grid">
                  <div class="runner-detail">
                    <span class="runner-detail-label">Base Duration</span>
                    <span id="runner-base-duration" class="runner-detail-value"
                      >0s</span
                    >
                  </div>
                  <div class="runner-detail">
                    <span class="runner-detail-label">Current Duration</span>
                    <span
                      id="runner-current-duration"
                      class="runner-detail-value"
                      >0s</span
                    >
                  </div>
                  <div class="runner-detail">
                    <span class="runner-detail-label">Occurrence</span>
                    <span
                      id="runner-occurrence-count"
                      class="runner-detail-value"
                      >0</span
                    >
                  </div>
                  <div class="runner-detail">
                    <span class="runner-detail-label">Time Change</span>
                    <span id="runner-change-delta" class="runner-detail-value"
                      >0s</span
                    >
                  </div>
                  <div class="runner-detail">
                    <span class="runner-detail-label">Total Change %</span>
                    <span
                      id="runner-change-percentage"
                      class="runner-detail-value"
                      >0%</span
                    >
                  </div>
                </div>
                <h4 id="task-progress-label" class="progress-section-label">
                  Task
                </h4>
                <div class="progress-bar-container">
                  <div
                    id="task-progress-bar"
                    role="progressbar"
                    aria-valuenow="0"
                    aria-valuemin="0"
                    aria-valuemax="100"
                  ></div>
                  <span id="task-percentage" class="percentage-indicator"
                    >0%</span
                  >
                </div>
                <div class="timer-display">
                  <div>
                    <span class="timer-label">Elapsed</span
                    ><span id="time-elapsed">0s</span>
                  </div>
                  <div>
                    <span class="timer-label">Remaining</span
                    ><span id="time-remaining">0s</span>
                  </div>
                </div>
                <div class="runner-controls">
                  <button
                    id="prev-task-btn"
                    class="runner-btn"
                    title="Previous Task"
                  >
                    <i class="fas fa-backward-step"></i><span>Prev</span>
                  </button>
                  <button
                    id="play-pause-btn"
                    class="runner-btn play"
                    title="Play/Pause"
                  >
                    <i class="fas fa-play"></i><span>Play</span>
                  </button>
                  <button
                    id="next-task-btn"
                    class="runner-btn"
                    title="Next Task"
                  >
                    <span>Next</span><i class="fas fa-forward-step"></i>
                  </button>
                </div>
                <div class="laps-section">
                  <div class="laps-section-header">
                    <h3>Laps</h3>
                    <div class="laps-controls">
                      <label for="laps-input">Runs:</label>
                      <div class="stepper-input">
                        <button
                          class="stepper-btn"
                          data-field="laps"
                          data-step="-1"
                          aria-label="Decrease laps"
                        >
                          -
                        </button>
                        <input
                          type="number"
                          id="laps-input"
                          value="1"
                          min="1"
                        />
                        <button
                          class="stepper-btn"
                          data-field="laps"
                          data-step="1"
                          aria-label="Increase laps"
                        >
                          +
                        </button>
                      </div>
                    </div>
                    <div id="session-controls" style="display: none">
                      <button
                        id="prev-lap-btn"
                        class="session-btn"
                        title="Previous Lap"
                      >
                        <i class="fas fa-angle-double-left"></i> Prev Lap
                      </button>
                      <button id="stop-laps-btn" class="session-btn stop">
                        Stop Session
                      </button>
                      <button
                        id="next-lap-btn"
                        class="session-btn"
                        title="Next Lap"
                      >
                        Next Lap <i class="fas fa-angle-double-right"></i>
                      </button>
                    </div>
                  </div>

                  <div
                    class="runner-progress-details"
                    id="laps-progress-container"
                    style="display: none"
                  >
                    <div class="divider"></div>
                    <h4 class="progress-section-label" id="laps-progress-label">
                      Lap Progress
                    </h4>
                    <div class="progress-bar-container">
                      <div
                        id="lap-progress-bar"
                        role="progressbar"
                        aria-valuenow="0"
                        aria-valuemin="0"
                        aria-valuemax="100"
                      ></div>
                      <span id="lap-percentage" class="percentage-indicator"
                        >0%</span
                      >
                    </div>
                    <div class="timer-display">
                      <div>
                        <span class="timer-label">Elapsed</span
                        ><span id="lap-time-elapsed">0s</span>
                      </div>
                      <div>
                        <span class="timer-label">Remaining</span
                        ><span id="lap-time-remaining">0s</span>
                      </div>
                    </div>
                    <div class="divider"></div>
                    <h4
                      class="progress-section-label"
                      id="session-progress-label"
                    >
                      Session
                    </h4>
                    <div class="progress-bar-container">
                      <div
                        id="session-progress-bar"
                        role="progressbar"
                        aria-valuenow="0"
                        aria-valuemin="0"
                        aria-valuemax="100"
                      ></div>
                      <span id="session-percentage" class="percentage-indicator"
                        >0%</span
                      >
                    </div>
                    <div class="timer-display">
                      <div>
                        <span class="timer-label">Elapsed</span
                        ><span id="session-time-elapsed">0s</span>
                      </div>
                      <div>
                        <span class="timer-label">Remaining</span
                        ><span id="session-time-remaining">0s</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>
      </main>
    </div>
    <div
      id="confirm-modal"
      class="modal-overlay"
      style="display: none"
      role="dialog"
      aria-modal="true"
      aria-labelledby="modal-title"
    >
      <div class="modal-content">
        <h2 class="modal-title" id="modal-title">Are you sure?</h2>
        <p id="modal-text"></p>
        <div class="modal-actions">
          <button id="modal-cancel-btn">Cancel</button>
          <button id="modal-confirm-btn">Confirm</button>
        </div>
      </div>
    </div>
    <script src="script.js" defer></script>
  </body>
</html>
